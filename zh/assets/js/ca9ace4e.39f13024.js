"use strict";(self.webpackChunkportal=self.webpackChunkportal||[]).push([[9220],{56495:(e,n,s)=>{s.r(n),s.d(n,{assets:()=>c,contentTitle:()=>i,default:()=>u,frontMatter:()=>o,metadata:()=>d,toc:()=>l});var t=s(74848),r=s(28453);const o={title:"Foundry",sidebar_position:1,description:"Testing and Deploying Smart Contracts using Foundry",slug:"/develop/auto-evm/guides/foundry",keywords:["autonomys network","\u9884\u7ea6 GetFoundry","\u94f8\u9020\u5382"]},i=void 0,d={id:"develop/nova/additional-guides/foundry_guide",title:"Foundry",description:"Testing and Deploying Smart Contracts using Foundry",source:"@site/i18n/zh/docusaurus-plugin-content-docs/current/develop/nova/additional-guides/foundry_guide.md",sourceDirName:"develop/nova/additional-guides",slug:"/develop/auto-evm/guides/foundry",permalink:"/zh/develop/auto-evm/guides/foundry",draft:!1,unlisted:!1,editUrl:"https://github.com/autonomys/subspace-docs/edit/main/docs/develop/nova/additional-guides/foundry_guide.md",tags:[],version:"current",sidebarPosition:1,frontMatter:{title:"Foundry",sidebar_position:1,description:"Testing and Deploying Smart Contracts using Foundry",slug:"/develop/auto-evm/guides/foundry",keywords:["autonomys network","\u9884\u7ea6 GetFoundry","\u94f8\u9020\u5382"]},sidebar:"tutorialSidebar",previous:{title:"Setting up MetaMask",permalink:"/zh/develop/auto-evm/metamask"},next:{title:"Hardhat",permalink:"/zh/develop/auto-evm/guides/hardhat"}},c={},l=[{value:"\u4f7f\u7528 [Foundry]\u6d4b\u8bd5\u548c\u90e8\u7f72\u667a\u80fd\u5408\u540c (https://book.getfoundry.sh/)",id:"\u4f7f\u7528-foundry\u6d4b\u8bd5\u548c\u90e8\u7f72\u667a\u80fd\u5408\u540c-httpsbookgetfoundrysh",level:3}];function a(e){const n={a:"a",admonition:"admonition",code:"code",h3:"h3",hr:"hr",img:"img",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,r.R)(),...e.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)(n.h3,{id:"\u4f7f\u7528-foundry\u6d4b\u8bd5\u548c\u90e8\u7f72\u667a\u80fd\u5408\u540c-httpsbookgetfoundrysh",children:["\u4f7f\u7528 [Foundry]\u6d4b\u8bd5\u548c\u90e8\u7f72\u667a\u80fd\u5408\u540c (",(0,t.jsx)(n.a,{href:"https://book.getfoundry.sh/",children:"https://book.getfoundry.sh/"}),")"]}),"\n",(0,t.jsx)(n.hr,{}),"\n",(0,t.jsxs)(n.ol,{children:["\n",(0,t.jsxs)(n.li,{children:["\u4f7f\u7528 ",(0,t.jsx)(n.code,{children:"foundryup"})," \u5de5\u5177\u94fe\u5b89\u88c5\u7a0b\u5e8f"]}),"\n"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:"curl -L https://foundry.paradigm.xyz | bash\n"})}),"\n",(0,t.jsxs)(n.p,{children:["\u8fd9\u5c06\u5b89\u88c5 ",(0,t.jsx)(n.code,{children:"foundryup"}),"\uff0c\u7136\u540e\u6309\u7167\u5c4f\u5e55\u4e0a\u7684\u8bf4\u660e\u8fdb\u884c\u64cd\u4f5c\uff0c\u8fd9\u5c06\u4f7ffoundryup\u547d\u4ee4\u5728\u60a8\u7684 CLI \u4e2d\u53ef\u7528\u3002\n\u8fd0\u884c",(0,t.jsx)(n.code,{children:"foundryup"}),"\u672c\u8eab\u5c06\u5b89\u88c5\u6700\u65b0\u7684\u9884\u7f16\u8bd1\u7684\u4e8c\u8fdb\u5236\u6587\u4ef6: ",(0,t.jsx)(n.code,{children:"forge"}),"\u3001",(0,t.jsx)(n.code,{children:"cast"}),"\u3001",(0,t.jsx)(n.code,{children:"anvil"}),"\u548c",(0,t.jsx)(n.code,{children:"chisel"}),"\u3002 \u66f4\u591a\u9009\u9879\u8bf7\u53c2\u9605",(0,t.jsx)(n.code,{children:"foundryup --help"})," \u3002"]}),"\n",(0,t.jsx)(n.admonition,{type:"note",children:(0,t.jsxs)(n.p,{children:["\u5982\u679c\u60a8\u4f7f\u7528\u7684\u662fWindows\uff0c\u5219\u9700\u8981\u5b89\u88c5\u5e76\u4f7f\u7528",(0,t.jsx)(n.a,{href:"https://gitforwindows.org/",children:"Git BASH"}),"\u6216 ",(0,t.jsx)(n.a,{href:"https://learn.microsoft.com/en-us/windows/wsl/install",children:"WSL"}),"\uff0c\u4f5c\u4e3a\u60a8\u7684\u7ec8\u7aef\uff0c\u56e0\u4e3aFoundryup\u76ee\u524d\u4e0d\u652f\u6301",(0,t.jsx)(n.code,{children:"PowerShell"}),"\u6216",(0,t.jsx)(n.code,{children:"Cmd"}),"\u3002"]})}),"\n",(0,t.jsxs)(n.ol,{start:"2",children:["\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsxs)(n.p,{children:["\u5b89\u88c5\u540e\uff0c\u521b\u5efa\u4e00\u4e2a\u9879\u76ee\u3002 \u6211\u4eec\u7684\u540d\u5b57\u662f ",(0,t.jsx)(n.code,{children:"hello_subspace"})," \u3002"]}),"\n",(0,t.jsx)(n.p,{children:"\u82e5\u8981\u521d\u59cb\u5316\u9879\u76ee\uff0c\u8bf7\u8fd0\u884c"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:"forge init hello_subspace\n"})}),"\n",(0,t.jsxs)(n.p,{children:["cd \u5230 ",(0,t.jsx)(n.code,{children:"hello_subspace"})," \u76ee\u5f55\uff0c\u8ba9\u6211\u4eec\u770b\u770b\u9879\u76ee\u7684\u7ed3\u6784\u3002"]}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.img,{alt:"Foundry-1",src:s(88772).A+"",width:"350",height:"250"})}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsxs)(n.p,{children:["\u6240\u6709\u5fc5\u8981\u7684\u56de\u8d2d\u7ed3\u6784\u90fd\u662f\u81ea\u52a8\u521b\u5efa\u7684\uff0c\u56e0\u6b64\u6211\u4eec\u53ef\u4ee5\u7acb\u5373\u5f00\u59cb\u7f16\u5199\u548c\u6d4b\u8bd5\u6211\u4eec\u7684\u667a\u80fd\u5408\u7ea6\u3002 As you can see, there are separate directories for storing smart contracts (src) and testing smart contracts (test).\n\u8ba9\u6211\u4eec\u770b\u770b",(0,t.jsx)(n.code,{children:"Counter.sol"}),"\u667a\u80fd\u5408\u7ea6\uff0c\u5e76\u4e3a\u6807\u51c6\u884c\u4e3a\u6dfb\u52a0\u66f4\u591a\u529f\u80fd\u3002 \u6211\u4eec\u7684\u667a\u80fd\u5408\u540c\u5c06\u6709\u4e09\u4e2a\u51fd\u6570\uff1a",(0,t.jsx)(n.code,{children:"setNumber()"}),"\uff0c\u5c06uint256\u6570\u5b57\u8bbe\u7f6e\u4e3a\u63d0\u4f9b\u7684\u503c\u3002 ",(0,t.jsx)(n.code,{children:"\u9012\u589e()"}),"\u4f1a\u589e\u52a0\u503c1 \u548c ",(0,t.jsx)(n.code,{children:"deciment()"}),"\u4f1a\u51cf\u5c11\u503c1\u3002"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{children:"// SPDX-License-Identifier: UNLICENSED\npragma solidity ^0.8.13;\n\ncontract Counter {\n    uint256 public number;\n\n    function setNumber(uint256 newNumber) public {\n        number = newNumber;\n    }\n\n    function increment() public {\n        number++;\n    }\n\n    function decrement() public {\n        number--;\n    }\n}\n"})}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsxs)(n.p,{children:["\u8ba9\u6211\u4eec\u786e\u4fdd\u6240\u6709\u51fd\u6570\u6b63\u5e38\u5de5\u4f5c\uff0c\u65b9\u6cd5\u662f\u5728 ",(0,t.jsx)(n.code,{children:"Counter.t.sol"})," \u6d4b\u8bd5\u6587\u4ef6\u4e2d\u6dfb\u52a0\u51e0\u4e2a\u6d4b\u8bd5\uff0c\u5e76\u68c0\u67e5\u5b83\u4eec\u662f\u5426\u901a\u8fc7\u3002"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{children:'// SPDX-License-Identifier: UNLICENSED\npragma solidity ^0.8.13;\n\nimport "forge-std/Test.sol";\nimport "../src/Counter.sol";\n\ncontract CounterTest is Test {\n    Counter public counter;\n\n    function setUp() public {\n        counter = new Counter();\n        counter.setNumber(2);\n    }\n\n    function testIncrement() public {\n        counter.increment();\n        assertEq(counter.number(), 3);\n    }\n\n    function testSetNumber(uint256 x) public {\n        counter.setNumber(x);\n        assertEq(counter.number(), x);\n    }\n\n    function testDecrement() public {\n        counter.decrement();\n        assertEq(counter.number(), 1);\n    }\n}\n'})}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsxs)(n.p,{children:["\u5728\u6211\u4eec\u7684\u6d4b\u8bd5\u4e2d\uff0c\u6211\u4eec\u9996\u5148\u5c06\u521d\u59cb\u503c\u8bbe\u7f6e\u4e3a2\u3002 \u7136\u540e\u68c0\u67e5\u51fd\u6570",(0,t.jsx)(n.code,{children:"\u9012\u589e()"}),"\u662f\u5426\u589e\u52a0\u503c1\uff0c\u5982\u679c",(0,t.jsx)(n.code,{children:"deciment()"}),"\u51cf\u5c11\u503c1\u3002\n\u8ba9\u6211\u4eec\u901a\u8fc7\u8fd0\u884c\u6765\u6784\u5efa\u4e00\u4e2a\u9879\u76ee\uff1a"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:"forge build\n"})}),"\n",(0,t.jsx)(n.p,{children:"\u5e76\u901a\u8fc7\u8fd0\u884c\u4ee5\u4e0b\u547d\u4ee4\u6765\u786e\u4fdd\u6d4b\u8bd5\u6309\u9884\u671f\u5de5\u4f5c"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:"forge test\n"})}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.img,{alt:"Foundry-2",src:s(27071).A+"",width:"1131",height:"350"})}),"\n",(0,t.jsx)(n.p,{children:"\u5f88\u597d\uff0c\u6240\u6709\u6d4b\u8bd5\u90fd\u901a\u8fc7\u4e86\uff0c\u8fd9\u610f\u5473\u7740\u667a\u80fd\u5408\u7ea6\u6b63\u5728\u6309\u9884\u671f\u5de5\u4f5c\u3002"}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsxs)(n.p,{children:["\u5176\u6b21\uff0c\u6211\u4eec\u9700\u8981\u8bbe\u7f6e",(0,t.jsx)(n.strong,{children:"\u4e24\u4ef6\u4e8b"}),"\uff0c\u4ee5\u4fbf",(0,t.jsx)(n.strong,{children:"\u90e8\u7f72\u6211\u4eec\u7684\u667a\u80fd\u5408\u540c"}),"\uff1a"]}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"We need to connect a wallet that has sufficient balance of tAI3 to cover the gas fees."}),"\n",(0,t.jsx)(n.li,{children:"\u6211\u4eec\u9700\u8981\u8bbe\u7f6e\u4e00\u4e2a\u7a0d\u540e\u4f7f\u7528\u7684\u73af\u5883\u53d8\u91cf\u3002"}),"\n"]}),"\n",(0,t.jsxs)(n.p,{children:["\u4e3a\u4e86\u4f7f\u6211\u4eec\u7684\u751f\u6d3b\u66f4\u5bb9\u6613\uff0c\u8ba9\u6211\u4eec\u521b\u5efa\u4e00\u4e2a\u65b0\u7684 ",(0,t.jsx)(n.code,{children:"Makefile"})," \u548c ",(0,t.jsx)(n.code,{children:".env"})," \u6587\u4ef6\u4f5c\u4e3a\u6211\u4eec\u9879\u76ee\u7684\u6839\u76ee\u5f55.\n",(0,t.jsx)(n.code,{children:".env"}),"\u6587\u4ef6\u901a\u5e38\u7528\u4e8e\u5b58\u50a8\u5e94\u7528\u7a0b\u5e8f\u7684\u73af\u5883\u53d8\u91cf\u3002 They are particularly useful for managing settings that change between deployment environments (e.g., development, testing, staging, and production), and for storing sensitive information."]}),"\n",(0,t.jsx)(n.p,{children:"\u73af\u5883\u53d8\u91cf\u53ef\u4ee5\u5305\u62ec\u6570\u636e\u5e93\u8fde\u63a5\u8be6\u7ec6\u4fe1\u606f\u3001API\u5bc6\u94a5\u3001\u5916\u90e8\u8d44\u6e90URI\u6216\u5176\u4ed6\u914d\u7f6e\u53d8\u91cf\uff0c\u8fd9\u4e9b\u53d8\u91cf\u53ef\u80fd\u4f1a\u6839\u636e\u5e94\u7528\u7a0b\u5e8f\u7684\u8fd0\u884c\u73af\u5883\u800c\u66f4\u6539\u3002 \u5728\u6211\u4eec\u7684\u793a\u4f8b\u4e2d\uff0c\u6211\u4eec\u5c06\u4f7f\u7528\u5b83\u6765\u6307\u5411\u6211\u4eec\u7684\u6838\u5fc3EVM RPC URL\uff0c\u65b9\u6cd5\u662f\u8bbe\u7f6e"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:"RPC_URL=https://nova-0.gemini-3h.subspace.network/ws\n"})}),"\n",(0,t.jsx)(n.p,{children:"\u7136\u540e\u4e3a\u517c\u5bb9EVM\u7684\u94b1\u5305\u8bbe\u7f6e\u79c1\u94a5"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:"PRIVATE_KEY=\u201dyour_private_key_value\u201d\n"})}),"\n",(0,t.jsx)(n.admonition,{type:"tip",children:(0,t.jsx)(n.p,{children:"\u91cd\u8981\u7684\u662f\u6ce8\u610f\u5230 nv \u6587\u4ef6\u4e0d\u5e94\u627f\u8bfa\u4e8e\u60a8\u7684\u6e90\u63a7\u5236(\u5982Git)\uff0c\u7279\u522b\u662f\u5f53\u5b83\u4eec\u5305\u542b\u654f\u611f\u6570\u636e\u65f6\uff0c\u5982\u60a8\u7684\u79c1\u94a5\u3002 \u8981\u9632\u6b62\u8fd9\u79cd\u60c5\u51b5\uff0c\u8bf7\u5c06.env\u6dfb\u52a0\u5230.gitignore\u6587\u4ef6\u4e2d\u3002 \u8fd9\u6709\u52a9\u4e8e\u786e\u4fdd\u654f\u611f\u5bc6\u94a5\u7684\u5b89\u5168\uff0c\u5e76\u907f\u514d\u5728\u5e94\u7528\u7a0b\u5e8f\u7684\u4ee3\u7801\u6216\u7248\u672c\u63a7\u5236\u5386\u53f2\u8bb0\u5f55\u4e2d\u66b4\u9732\u5b83\u4eec\u7684\u98ce\u9669\u3002"})}),"\n",(0,t.jsx)(n.p,{children:"In the Makefile, let\u2019s create shortcuts to the main features of the application"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:"# include .env file and export its env vars\n-include .env\n\n# Builds\nbuild:\n    @forge clean && forge build --optimize --optimizer-runs 1000000\n\n# Deployment\ndeploy:\n    @forge create Counter --private-key ${PRIVATE_KEY} --rpc-url ${RPC_URL}\n"})}),"\n",(0,t.jsxs)(n.p,{children:["We're importing the values for a ",(0,t.jsx)(n.code,{children:"PRIVATE_KEY"})," and ",(0,t.jsx)(n.code,{children:"RPC_URL"})," from the ",(0,t.jsx)(n.code,{children:".env"})," file."]}),"\n",(0,t.jsxs)(n.p,{children:["This allows us to run ",(0,t.jsx)(n.code,{children:"make build"})," for building the project and ",(0,t.jsx)(n.code,{children:"make deploy"})," for deploying the project pointing to the provided RPC and using the provided private_key."]}),"\n",(0,t.jsx)(n.p,{children:"Let\u2019s run"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{children:"make build\n"})}),"\n",(0,t.jsx)(n.p,{children:"to make sure it\u2019s working properly."}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.img,{alt:"Foundry-3",src:s(47094).A+"",width:"1422",height:"350"})}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsxs)(n.p,{children:["In order to deploy your contract using the specified ",(0,t.jsx)(n.strong,{children:(0,t.jsx)(n.code,{children:"RPC"})})," and ",(0,t.jsx)(n.strong,{children:(0,t.jsx)(n.code,{children:"PRIVATE_KEY"})})," just run"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{children:"make deploy\n"})}),"\n",(0,t.jsx)(n.admonition,{type:"caution",children:(0,t.jsxs)(n.p,{children:["Do not attempt to speed up a transaction (do not include a tip on top of the gas fees). To read more about this, please refer to ",(0,t.jsx)(n.a,{href:"/develop/auto-evm/introduction#important-note-about-submitting-a-transaction",children:"this section"}),"."]})}),"\n",(0,t.jsx)(n.admonition,{type:"caution",children:(0,t.jsxs)(n.p,{children:["In some cases when deploying the script, you may experience ",(0,t.jsx)(n.strong,{children:'"No manual gas limit set"'})," or ",(0,t.jsx)(n.strong,{children:'"Gas estimation failed"'})," issues. Please refer to ",(0,t.jsx)(n.a,{href:"/develop/auto-evm/introduction#gas-estimation-issue",children:"this section"})," for the solution."]})}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"Congratulations"}),", you've successfully deployed your smart contract on Autonomys EVM!"]}),"\n"]}),"\n"]})]})}function u(e={}){const{wrapper:n}={...(0,r.R)(),...e.components};return n?(0,t.jsx)(n,{...e,children:(0,t.jsx)(a,{...e})}):a(e)}},88772:(e,n,s)=>{s.d(n,{A:()=>t});const t=s.p+"assets/images/Foundry-1-8a5c8b8884057c2e65c262979101e51e.png"},27071:(e,n,s)=>{s.d(n,{A:()=>t});const t=s.p+"assets/images/Foundry-2-0905b0bb14b8f7886ef052b7a0722432.png"},47094:(e,n,s)=>{s.d(n,{A:()=>t});const t=s.p+"assets/images/Foundry-3-38f4e98f2679f9e6f8f94bdc7c392e4e.png"},28453:(e,n,s)=>{s.d(n,{R:()=>i,x:()=>d});var t=s(96540);const r={},o=t.createContext(r);function i(e){const n=t.useContext(o);return t.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function d(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:i(e.components),t.createElement(o.Provider,{value:n},e.children)}}}]);